# Financial Benchmark Analysis

ê¸ˆìœµ ìì‚°ë“¤ì˜ ì„±ê³¼ë¥¼ ë¹„êµ ë¶„ì„í•˜ëŠ” Node.js í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. Yahoo Finance APIì™€ Coinone APIë¥¼ í™œìš©í•˜ì—¬ ë‹¤ì–‘í•œ ìì‚°ì˜ ìˆ˜ìµë¥ ê³¼ ìµœëŒ€ ë‚™í­(MDD)ì„ ê³„ì‚°í•˜ê³ , Supabaseì— ìë™ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

## ğŸ“Š ë¶„ì„ ëŒ€ìƒ ìì‚°

- **Gold (GLD)**: ê¸ˆ ETF
- **S&P500 (^GSPC)**: ë¯¸êµ­ S&P 500 ì§€ìˆ˜
- **KOSPI (^KS11)**: í•œêµ­ ì¢…í•©ì£¼ê°€ì§€ìˆ˜
- **Bitcoin (KRW)**: ì›í™” ê¸°ì¤€ ë¹„íŠ¸ì½”ì¸

## ğŸ“ˆ ë¶„ì„ ê¸°ê°„

ê° ìì‚°ë³„ë¡œ ë‹¤ìŒ ê¸°ê°„ì˜ ì„±ê³¼ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤:
- **1ê°œì›” (1m)**: ìµœê·¼ 30ì¼
- **3ê°œì›” (3m)**: ìµœê·¼ 90ì¼
- **6ê°œì›” (6m)**: ìµœê·¼ 180ì¼
- **1ë…„ (12m)**: ìµœê·¼ 365ì¼

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### 1. ì˜ì¡´ì„± ì„¤ì¹˜
```bash
npm install
```

### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
```bash
# .env íŒŒì¼ ìƒì„±
cp .env.example .env

# .env íŒŒì¼ í¸ì§‘í•˜ì—¬ Supabase ì •ë³´ ì…ë ¥
SUPABASE_URL=your_supabase_url_here
SUPABASE_ANON_KEY=your_supabase_anon_key_here
```

### 3. ì‹¤í–‰ ì˜µì…˜

#### ì¼íšŒì„± ì‹¤í–‰
```bash
npm start
```

#### ìë™í™” ìŠ¤ì¼€ì¤„ëŸ¬ ì‹¤í–‰ (ë§¤ì¼ ì˜¤ì „ 9ì‹œ)
```bash
npm run scheduler
```

## ğŸ“ˆ ë¶„ì„ ì§€í‘œ

### ìˆ˜ìµë¥  (ROR - Return on Return %)
- ë¶„ì„ ê¸°ê°„ ë™ì•ˆì˜ ì´ ìˆ˜ìµë¥ ì„ ë°±ë¶„ìœ¨ë¡œ í‘œì‹œ
- `(ìµœì¢…ê°€ê²© / ì´ˆê¸°ê°€ê²© - 1) Ã— 100`

### ìµœëŒ€ ë‚™í­ (MDD - Maximum Drawdown %)
- ë¶„ì„ ê¸°ê°„ ë™ì•ˆ ë°œìƒí•œ ìµœëŒ€ ì†ì‹¤ë¥ 
- ê³ ì  ëŒ€ë¹„ ìµœì €ì ê¹Œì§€ì˜ í•˜ë½í­

## ğŸ’¾ ë°ì´í„° ì €ì¥

### Supabase í…Œì´ë¸” êµ¬ì¡°
ë¶„ì„ ê²°ê³¼ëŠ” `benchmark` í…Œì´ë¸”ì— ë‹¤ìŒ êµ¬ì¡°ë¡œ ì €ì¥ë©ë‹ˆë‹¤:

```sql
CREATE TABLE benchmark (
  name TEXT NOT NULL PRIMARY KEY,
  ror_1m DECIMAL(10,2),
  mdd_1m DECIMAL(10,2),
  ror_3m DECIMAL(10,2),
  mdd_3m DECIMAL(10,2),
  ror_6m DECIMAL(10,2),
  mdd_6m DECIMAL(10,2),
  ror_12m DECIMAL(10,2),
  mdd_12m DECIMAL(10,2)
);
```

### ì €ì¥ë˜ëŠ” ë°ì´í„°
- **name**: ìì‚°ëª… (Primary Key)
- **ror_1m**: 1ê°œì›” ìˆ˜ìµë¥  (%)
- **mdd_1m**: 1ê°œì›” ìµœëŒ€ ë‚™í­ (%)
- **ror_3m**: 3ê°œì›” ìˆ˜ìµë¥  (%)
- **mdd_3m**: 3ê°œì›” ìµœëŒ€ ë‚™í­ (%)
- **ror_6m**: 6ê°œì›” ìˆ˜ìµë¥  (%)
- **mdd_6m**: 6ê°œì›” ìµœëŒ€ ë‚™í­ (%)
- **ror_12m**: 1ë…„ ìˆ˜ìµë¥  (%)
- **mdd_12m**: 1ë…„ ìµœëŒ€ ë‚™í­ (%)

### ì—…ë°ì´íŠ¸ ë°©ì‹
- **Upsert ë°©ì‹**: ê¸°ì¡´ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸, ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
- **Primary Key**: `name` í•„ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µ ì²˜ë¦¬
- **ì‹¤í–‰ ì‹œì **: ë§¤ì¼ ìŠ¤ì¼€ì¤„ëŸ¬ ì‹¤í–‰ ì‹œ ìµœì‹  ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸

## âš™ï¸ ì„¤ì •

### ë¶„ì„ ê¸°ê°„ ì„¤ì •
`index.js` íŒŒì¼ì—ì„œ ë¶„ì„ ê¸°ê°„ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```javascript
const PERIODS = {
  '1m': 30,    // 1ê°œì›”
  '3m': 90,    // 3ê°œì›”
  '6m': 180,   // 6ê°œì›”
  '12m': 365   // 1ë…„
};
```

### ìì‚° ì„¤ì •
`ASSETS` ê°ì²´ì—ì„œ ë¶„ì„í•  ìì‚°ì„ ì¶”ê°€/ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```javascript
const ASSETS = {
  Gold: 'GLD',
  'S&P500': '^GSPC',
  KOSPI: '^KS11',
  // ìƒˆë¡œìš´ ìì‚° ì¶”ê°€ ê°€ëŠ¥
  // 'ìì‚°ëª…': 'Yahoo Finance ì‹¬ë³¼'
};
```

## ğŸ“¦ ì‚¬ìš©ëœ ê¸°ìˆ 

- **Node.js**: ëŸ°íƒ€ì„ í™˜ê²½
- **yahoo-finance2**: Yahoo Finance API í´ë¼ì´ì–¸íŠ¸
- **axios**: HTTP í´ë¼ì´ì–¸íŠ¸ (Coinone API í˜¸ì¶œìš©)
- **@supabase/supabase-js**: Supabase í´ë¼ì´ì–¸íŠ¸
- **dotenv**: í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
- **ES Modules**: ìµœì‹  JavaScript ëª¨ë“ˆ ì‹œìŠ¤í…œ

## ğŸ”§ API ì •ë³´

### Yahoo Finance API
- ì£¼ì‹, ETF, ì§€ìˆ˜ ë°ì´í„° ì œê³µ
- ë¬´ë£Œ ì‚¬ìš© ê°€ëŠ¥
- ì¼ë³„ ì¢…ê°€ ë°ì´í„° í™œìš©

### Coinone API
- ë¹„íŠ¸ì½”ì¸ ì›í™” ê±°ë˜ ë°ì´í„° ì œê³µ
- ê³µê°œ API (ì¸ì¦ ë¶ˆí•„ìš”)
- ì¼ë³„ ìº”ë“¤ ë°ì´í„° í™œìš©

### Supabase
- PostgreSQL ê¸°ë°˜ ë°±ì—”ë“œ ì„œë¹„ìŠ¤
- ì‹¤ì‹œê°„ ë°ì´í„°ë² ì´ìŠ¤
- RESTful API ì œê³µ

## ğŸ“‹ ì¶œë ¥ ì˜ˆì‹œ

```
ğŸ“Š ë¶„ì„ ê¸°ê°„: 2024-12-31 ê¸°ì¤€
ğŸ”„ ë°ì´í„° ìˆ˜ì§‘ ì¤‘...

ğŸ“ˆ Gold ë¶„ì„ ì¤‘...
  1m: ROR 2.15%, MDD -1.23%
  3m: ROR 8.45%, MDD -3.67%
  6m: ROR 15.23%, MDD -7.89%
  12m: ROR 27.98%, MDD -12.34%

ğŸ“ˆ S&P500 ë¶„ì„ ì¤‘...
  1m: ROR -1.23%, MDD -5.67%
  3m: ROR 3.45%, MDD -8.90%
  6m: ROR -0.21%, MDD -15.67%
  12m: ROR 12.34%, MDD -18.90%

ğŸ’¾ Supabaseì— ì €ì¥ ì¤‘...
âœ… GOLD ì—…ë°ì´íŠ¸ ì™„ë£Œ
âœ… S&P500 ì—…ë°ì´íŠ¸ ì™„ë£Œ
âœ… KOSPI ì—…ë°ì´íŠ¸ ì™„ë£Œ
âœ… BTC ì—…ë°ì´íŠ¸ ì™„ë£Œ
âœ… ëª¨ë“  ì‘ì—… ì™„ë£Œ!
```

## ğŸ› ï¸ ê°œë°œ

### í”„ë¡œì íŠ¸ êµ¬ì¡°
```
benchmark/
â”œâ”€â”€ package.json      # í”„ë¡œì íŠ¸ ì„¤ì • ë° ì˜ì¡´ì„±
â”œâ”€â”€ index.js          # ë©”ì¸ ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ scheduler.js      # ìë™í™” ìŠ¤ì¼€ì¤„ëŸ¬
â”œâ”€â”€ .env              # í™˜ê²½ ë³€ìˆ˜ (ë¡œì»¬)
â”œâ”€â”€ .gitignore        # Git ì œì™¸ íŒŒì¼ ì„¤ì •
â””â”€â”€ README.md         # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

### ì£¼ìš” í•¨ìˆ˜

- `maxDrawdown(arr)`: ìµœëŒ€ ë‚™í­ ê³„ì‚°
- `fetchYahoo(symbol, startDate)`: Yahoo Finance ë°ì´í„° ë¡œë”©
- `fetchCoinoneKRW_BTC(startDate)`: Coinone ë¹„íŠ¸ì½”ì¸ ë°ì´í„° ë¡œë”©
- `calculatePeriodMetrics(symbol, periodDays)`: íŠ¹ì • ê¸°ê°„ ë¶„ì„
- `saveToSupabase(results)`: Supabaseì— ë°ì´í„° ì €ì¥
- `main()`: ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜

## ğŸ”„ ìë™í™”

### ìŠ¤ì¼€ì¤„ëŸ¬ ì‹¤í–‰
```bash
npm run scheduler
```

### ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ (Linux/Mac)
```bash
nohup npm run scheduler > scheduler.log 2>&1 &
```

### PM2ë¥¼ ì‚¬ìš©í•œ í”„ë¡œë•ì…˜ ì‹¤í–‰
```bash
npm install -g pm2
pm2 start scheduler.js --name "benchmark-scheduler"
pm2 save
pm2 startup
```

## ğŸ“ ë¼ì´ì„ ìŠ¤

ISC License

## ğŸ¤ ê¸°ì—¬

ì´ìŠˆë‚˜ ê°œì„ ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ ì œì•ˆí•´ì£¼ì„¸ìš”!
